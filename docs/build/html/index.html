

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FRApy: Fitting Resolved Arcs with python &mdash; FRApy beta documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="#" class="icon icon-home"> FRApy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">FRApy: Fitting Resolved Arcs with python</a><ul>
<li><a class="reference internal" href="#intro">Intro</a><ul>
<li><a class="reference internal" href="#graviatational-arcs">Graviatational arcs</a></li>
<li><a class="reference internal" href="#what-you-ll-need">What you’ll need</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#quick-start">Quick start</a></li>
<li><a class="reference internal" href="#mode-in-depth-demos">Mode in depth demos</a><ul>
<li><a class="reference internal" href="#fitting-a-metallicity-gradient">Fitting  a Metallicity Gradient</a></li>
<li><a class="reference internal" href="#fitting-velocity-field">Fitting Velocity Field</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authors-and-citations">Authors and Citations</a></li>
<li><a class="reference internal" href="#code-documentation">Code Documentation</a><ul>
<li><a class="reference internal" href="#module-frapy.observations">Observations</a></li>
<li><a class="reference internal" href="#module-frapy.models">Models</a></li>
<li><a class="reference internal" href="#module-frapy.fit_model">Fitting</a></li>
<li><a class="reference internal" href="#module-frapy.check_fit">Explore the output</a></li>
<li><a class="reference internal" href="#module-frapy.utils">Miscelaneous</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">FRApy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>FRApy: Fitting Resolved Arcs with python</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="frapy-fitting-resolved-arcs-with-python">
<h1>FRApy: Fitting Resolved Arcs with python<a class="headerlink" href="#frapy-fitting-resolved-arcs-with-python" title="Permalink to this headline">¶</a></h1>
<p>FRApy is python code designed to fit gravitational arcs in image plane with analytical modes, such as metallicity gradients and velocity fields, taking into account the lensing distortions.</p>
<div class="section" id="intro">
<h2>Intro<a class="headerlink" href="#intro" title="Permalink to this headline">¶</a></h2>
<div class="section" id="graviatational-arcs">
<h3>Graviatational arcs<a class="headerlink" href="#graviatational-arcs" title="Permalink to this headline">¶</a></h3>
<p>Gravitational arcs are galaxies in the backgroud of a cluster of galaxies or a massive galaxy. These massive objects act as a <em>magnifying lens</em>, increasing the size of the backgroud galaxies in the sky, which allows us to resolve them to smaller spatial scales. However, the magnification is not uniform, and the lensed galaxies appear ‘distorted’ in the sky, typically in an arc-like shape (hence the name graviational ‘arcs’).</p>
<div class="figure" id="id1">
<a class="reference internal image-reference" href="_images/a370.png"><img alt="Example of graviational arc." src="_images/a370.png" style="width: 651.6px; height: 304.8px;" /></a>
<p class="caption"><span class="caption-text">This is a gravitational arc called ‘the dragon’ lensed by the cluster Abell 370. On the left, you can see it in <em>image plane</em>, i.e. as it is in the sky, magnified it all its messy glory. On the right, we have use a lensing model to correct this magnification and get ‘the real galaxy’. This is called the <em>source plane</em> image.</span></p>
</div>
<p>The spatial distortion makes the analysis of these objects more difficult, especially when several images of the same object (called multiple images) are available. FRApy deals with this issue through forward-modelling: we start with a model in source plane (the ‘undistorted’ galaxy), lense it to image plane using a lensing model and compare it with the data.</p>
</div>
<div class="section" id="what-you-ll-need">
<h3>What you’ll need<a class="headerlink" href="#what-you-ll-need" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Deflection maps. These are images produced from a lensing model that map how much deflection (in arcseconds) a little photon originated in position x,y in the sky will suffer due to the gravitational lens. This is the core of FRApy’s modelling and allows us to generate lensed images that can be compared with the observations. We do this by calculating where each pixel in source plane will ‘land’ in image plane. A number of Frontier Fields models provide these maps, you can check them <a class="reference external" href="https://archive.stsci.edu/pub/hlsp/frontier/abell370/models/">here</a>.</li>
</ol>
<p>2. An analytical model that you hope describes your data, such as a gradient for metallicity or an arctangent model velocity fields. FRApy comes with a number of these models,
that we used in our own publications, but we also show how you can create and fit your own model.</p>
</div>
</div>
<div class="section" id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<p>WORK IN PROGRESS.</p>
<p>Right now, the project is available <a class="reference external" href="https://github.com/VeraPatricio/FRApy">GitHub</a>.</p>
<p>It requires the following packages:</p>
<blockquote>
<div>numpy==1.15.4
matplotlib==3.0.2
astropy==3.1
reproject==0.4
emcee==2.2.1
pickle==4.0
corner==2.0.1</div></blockquote>
</div>
<div class="section" id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>FRApy is a python module. A minimum working example would look something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import FRApy</span>
<span class="kn">from</span> <span class="nn">frapy</span> <span class="kn">import</span> <span class="n">Observation</span><span class="p">,</span><span class="n">Metallicity_Gradient</span><span class="p">,</span><span class="n">Output</span>
<span class="kn">from</span> <span class="nn">frappy</span> <span class="kn">import</span> <span class="n">fit_model</span><span class="p">,</span><span class="n">make_input_parameters</span>

<span class="c1"># Load Observations</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mf">0.611</span><span class="p">,</span>
                  <span class="n">data_path</span><span class="o">=</span><span class="s1">&#39;Demo_data/AS1063_map_metallicity.fits&#39;</span><span class="p">,</span>
                  <span class="n">unc_path</span><span class="o">=</span><span class="s1">&#39;Demo_data/AS1063_map_metallicity_unc.fits&#39;</span><span class="p">,</span>
                  <span class="n">seeing</span> <span class="o">=</span> <span class="mf">1.03</span><span class="o">/</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Choose a Model, in this case a linear metallicity gradient</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Metallicity_Gradient</span><span class="p">(</span><span class="n">zlens</span><span class="o">=</span><span class="mf">0.322</span><span class="p">,</span>
                             <span class="n">dfx_path</span><span class="o">=</span><span class="s1">&#39;Demo_data/AS1063_dplx.fits&#39;</span><span class="p">,</span>
                             <span class="n">dfy_path</span><span class="o">=</span><span class="s1">&#39;Demo_data/AS1063_dply.fits&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">create_projection_maps</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="c1"># Fit the data</span>
<span class="n">input_par</span> <span class="o">=</span> <span class="n">make_input_parameters</span><span class="p">(</span><span class="n">name</span>    <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="s1">&#39;cy&#39;</span><span class="p">,</span>  <span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;pa&#39;</span><span class="p">,</span> <span class="s1">&#39;z_grad&#39;</span><span class="p">,</span> <span class="s1">&#39;z_0&#39;</span><span class="p">),</span>
                                  <span class="n">value</span>   <span class="o">=</span> <span class="p">(</span>  <span class="mi">29</span><span class="p">,</span>   <span class="mi">23</span><span class="p">,</span>  <span class="mf">0.7</span><span class="p">,</span>   <span class="mi">20</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">),</span>
                                  <span class="n">minimum</span> <span class="o">=</span> <span class="p">(</span>  <span class="mi">28</span><span class="p">,</span>   <span class="mi">22</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">,</span>  <span class="o">-</span><span class="mi">20</span><span class="p">,</span>     <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">),</span>
                                  <span class="n">maximum</span> <span class="o">=</span> <span class="p">(</span>  <span class="mi">33</span><span class="p">,</span>   <span class="mi">27</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span>   <span class="mi">90</span><span class="p">,</span>      <span class="mf">0.0</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">))</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">fit_model</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">input_par</span><span class="p">,</span><span class="s1">&#39;output_file&#39;</span><span class="p">,</span><span class="n">nsteps</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="n">nwalkers</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="c1"># Inspect the fit</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;output_file&#39;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">best_parameters</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="mode-in-depth-demos">
<h2>Mode in depth demos<a class="headerlink" href="#mode-in-depth-demos" title="Permalink to this headline">¶</a></h2>
<p>We have included demo data used in Patricio et al. in prep. and two notebooks with examples on how to fit your data.</p>
<p>Click here and here!</p>
<div class="section" id="fitting-a-metallicity-gradient">
<h3>Fitting  a Metallicity Gradient<a class="headerlink" href="#fitting-a-metallicity-gradient" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/VeraPatricio/FRApy/blob/master/examples/demo_fit_metallicity_gradient.ipynb">Metallicity Gradient Example</a>.</p>
</div>
<div class="section" id="fitting-velocity-field">
<h3>Fitting Velocity Field<a class="headerlink" href="#fitting-velocity-field" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/VeraPatricio/FRApy/blob/master/examples/demo_fit_velocity_model.ipynb">Velocity Field Example</a>.</p>
</div>
</div>
<div class="section" id="authors-and-citations">
<h2>Authors and Citations<a class="headerlink" href="#authors-and-citations" title="Permalink to this headline">¶</a></h2>
<p>This code was developed by:</p>
<ul class="simple">
<li>Vera Patricio (<a class="reference external" href="mailto:vera&#46;patricio&#37;&#52;&#48;dark-cosmology&#46;dk">vera<span>&#46;</span>patricio<span>&#64;</span>dark-cosmology<span>&#46;</span>dk</a>), main contributer</li>
<li>Johan Richard, lensing specialist</li>
</ul>
<p>If you use FRApy in your science, please add the following citation:</p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2018MNRAS.477...18P/abstract">Patrício et. al, 2018</a>.</p>
<p>and</p>
<p>Patrício et. al, in prep.</p>
<p>and don’t forget <a class="reference external" href="http://www.astropy.org/">astropy</a> and <a class="reference external" href="http://dfm.io/emcee/current/">emcee</a>!</p>
</div>
<div class="section" id="code-documentation">
<h2>Code Documentation<a class="headerlink" href="#code-documentation" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="module-frapy.observations">
<span id="observations"></span><h3>Observations<a class="headerlink" href="#module-frapy.observations" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="frapy.observations.Observation">
<em class="property">class </em><code class="descclassname">frapy.observations.</code><code class="descname">Observation</code><span class="sig-paren">(</span><em>data_path</em>, <em>z</em>, <em>unc_path=None</em>, <em>seeing=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/observations.html#Observation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.observations.Observation" title="Permalink to this definition">¶</a></dt>
<dd><p>Data to be fitted.</p>
<p>This class handles the data that is going to be fitted with the models. It includes
the image (data) to be fit, the associated uncertainty (optionally ), the redshift
of the object and the seeing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path to the fits file containing the data.</li>
<li><strong>unc_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path to the fits file containing the associated uncertainty (optional).</li>
<li><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Redshift.</li>
<li><strong>seeing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Seeing (in pixels). To be used in the model convolution.</li>
<li><strong>data</strong> (<em>float array</em>) – Data to be fitted. It is read from the data_path</li>
<li><strong>unc</strong> (<em>float array</em>) – Data uncertainted. It is read from the unc_path.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="frapy.observations.Observation.info">
<code class="descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/observations.html#Observation.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.observations.Observation.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the data file, redshift and seeing.</p>
</dd></dl>

<dl class="method">
<dt id="frapy.observations.Observation.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>data_lim=None</em>, <em>unc_lim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/observations.html#Observation.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.observations.Observation.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the data and uncertainty.
:param data_lim: minimum and maximum values of the data colour bar.
:type data_lim: (float,float)
:param unc_lim: minimum and maximum values of the uncertainty colour bar.
:type unc_lim: (float,float)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-frapy.models">
<span id="models"></span><h3>Models<a class="headerlink" href="#module-frapy.models" title="Permalink to this headline">¶</a></h3>
<p>The BaseModel handles all the lensing part, producing a distance map
that is used by all the other models. At the moment, the following
models are implemented:</p>
<blockquote>
<div><ul class="simple">
<li>Metallcity gradient</li>
<li>Arctangent velocity</li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="frapy.models.BaseModel">
<em class="property">class </em><code class="descclassname">frapy.models.</code><code class="descname">BaseModel</code><span class="sig-paren">(</span><em>zlens</em>, <em>dfx_path</em>, <em>dfy_path</em>, <em>df_ang=0</em>, <em>cx=0</em>, <em>cy=0</em>, <em>q=1</em>, <em>pa=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#BaseModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.BaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Global lensing model to be used in all other Model classes .</p>
<p>This class prepares the deflection maps to be used with a particular object (i.e.
at a particular redshift) and observations (i.e. aligns the maps with the data).</p>
<p>The main output is a distance map, in kiloparsecs, and an azimuthal map that serve
as base for all the models being fit (metallicity gradient, velocity…)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z_lens</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Redshift of the gravitational lens.</li>
<li><strong>dfx_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path to the fits file with the x deflection.</li>
<li><strong>dfy_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path to the fits file with the y deflection.</li>
<li><strong>cx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – x position of the centre (in pixels)</li>
<li><strong>cy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – y position of the centre (in pixels)</li>
<li><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – axis ratio (b/a)</li>
<li><strong>pa</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Position angle (0 North, +90 East )</li>
<li><strong>df_ang</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Angle between x axis and North (measured anti-clockwise) in the deflection maps.</li>
<li><strong>project_x</strong> (<em>float array</em>) – Lensing model (deflection in x direction) to be used to a particular object.
Created with the ‘create_deflection_maps_for_object’ method.</li>
<li><strong>project_y</strong> (<em>float array</em>) – Lensing model (deflection in y direction) to be used to a particular object.
Created with the ‘create_deflection_maps_for_object’ method.</li>
<li><strong>data</strong> (<em>array</em>) – An array with a realisation of a model made from the current parameter values.</li>
<li><strong>conv_data</strong> (<em>array</em>) – An array with a realisation of a model made from the current parameter values,
convolved by the seeing of observations.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="frapy.models.BaseModel.convolve_with_seeing">
<code class="descname">convolve_with_seeing</code><span class="sig-paren">(</span><em>seeing</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#BaseModel.convolve_with_seeing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.BaseModel.convolve_with_seeing" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolves a model with a Gaussian with width (sigma) ‘seeing’.</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.BaseModel.create_projection_maps">
<code class="descname">create_projection_maps</code><span class="sig-paren">(</span><em>Observation</em>, <em>correct_z=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#BaseModel.create_projection_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.BaseModel.create_projection_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the more global deflection maps produced by a graviatational
lensing fitting code, and converts these maps to ‘projection’ maps, that
maps where a pixel in source plane should be ‘projected’ in image plane,
for this particular Observation. The project_x and project_y attributes
are created with this function.</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.BaseModel.lensing_info">
<code class="descname">lensing_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#BaseModel.lensing_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.BaseModel.lensing_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the lens redshift and deflection maps origin</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.BaseModel.make_azimuthal_map">
<code class="descname">make_azimuthal_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#BaseModel.make_azimuthal_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.BaseModel.make_azimuthal_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces an azimuthal map, in kpc, centrered in ‘cx’,’cy’ and assuming a ratio of
‘q’ between the minor and major axis, with the major axis in the ‘pa’ direction.</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.BaseModel.make_distance_map">
<code class="descname">make_distance_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#BaseModel.make_distance_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.BaseModel.make_distance_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a distance map, in kpc, centrered in ‘cx’,’cy’ and assuming a ratio of
‘q’ between the minor and major axis, with the major axis in the ‘pa’ direction.</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.BaseModel.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#BaseModel.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.BaseModel.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the model</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="frapy.models.Metallicity_Gradient">
<em class="property">class </em><code class="descclassname">frapy.models.</code><code class="descname">Metallicity_Gradient</code><span class="sig-paren">(</span><em>zlens</em>, <em>dfx_path</em>, <em>dfy_path</em>, <em>df_ang=0</em>, <em>cx=0</em>, <em>cy=0</em>, <em>q=1</em>, <em>pa=0</em>, <em>z_grad=-1</em>, <em>z_0=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear metallicity gradient.</p>
<p>This model inherits the distance maps attributes (cx,cy,q and pa), from which the metallicity
at each point is calculated assuming a gradient and a central metallicity value:</p>
<p>Z(r) = Delta Z * r + Z_0</p>
<p>with r the radius in kpc, Delta Z the gradient in dex/kpc, Z_0 the central metallicity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – x position of the centre (in pixels)</li>
<li><strong>cy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – y position of the centre (in pixels)</li>
<li><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – axis ratio (a/b)</li>
<li><strong>pa</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Position angle (0 North, +90 East )</li>
<li><strong>z_grad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Gradient in dex/kpc.</li>
<li><strong>z_0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Central metallicity value (value at cx,cy)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="frapy.models.Metallicity_Gradient.make_model">
<code class="descname">make_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient.make_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient.make_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a model using the current parameters’ values and stores it
in the ‘data’ attribute</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Metallicity_Gradient.model_name">
<code class="descname">model_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient.model_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient.model_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s name</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Metallicity_Gradient.model_parameters">
<code class="descname">model_parameters</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient.model_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient.model_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s parameters</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Metallicity_Gradient.print_parameter_values">
<code class="descname">print_parameter_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient.print_parameter_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient.print_parameter_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s parameters values</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Metallicity_Gradient.update_model_parameters">
<code class="descname">update_model_parameters</code><span class="sig-paren">(</span><em>par</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient.update_model_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient.update_model_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the parameters of the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>par</strong> (<em>dictionary</em>) – dictionary in the shape {‘name’:parameter_name, ‘value’:parameter value}</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="frapy.models.Metallicity_Gradient_Constant_Centre">
<em class="property">class </em><code class="descclassname">frapy.models.</code><code class="descname">Metallicity_Gradient_Constant_Centre</code><span class="sig-paren">(</span><em>zlens</em>, <em>dfx_path</em>, <em>dfy_path</em>, <em>cx=0</em>, <em>cy=0</em>, <em>q=1</em>, <em>pa=0</em>, <em>z_grad=-1</em>, <em>z_0=0</em>, <em>r_flat=0.5</em>, <em>z_grad_inner=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient_Constant_Centre"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient_Constant_Centre" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear metallicity gradient with a flatenning of the centre at r_flat.</p>
<p>This model inherits the distance maps attributes (cx,cy,q and pa), from which the metallicity
at each point is calculated assuming a gradient and a central metallicity value:</p>
<p>Z(r) = Delta Z * r + Z_0</p>
<p>with r the radius in kpc, Delta Z the gradient in dex/kpc, Z_0 the central metallicity.</p>
<p>For r &lt; r_flat, the metallicity is constant.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – x position of the centre (in pixels)</li>
<li><strong>cy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – y position of the centre (in pixels)</li>
<li><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – axis ratio (a/b)</li>
<li><strong>pa</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Position angle (0 North, +90 East )</li>
<li><strong>z_grad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Gradient in dex/kpc.</li>
<li><strong>z_0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Central metallicity value (value at cx,cy)</li>
<li><strong>r_flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Radius that delimits the central zone where the metallicity is flat</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="frapy.models.Metallicity_Gradient_Constant_Centre.make_model">
<code class="descname">make_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient_Constant_Centre.make_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient_Constant_Centre.make_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a model using the current parameters’ values and stores it
in the ‘data’ attribute</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Metallicity_Gradient_Constant_Centre.model_name">
<code class="descname">model_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient_Constant_Centre.model_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient_Constant_Centre.model_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s name</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Metallicity_Gradient_Constant_Centre.model_parameters">
<code class="descname">model_parameters</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient_Constant_Centre.model_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient_Constant_Centre.model_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s parameters</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Metallicity_Gradient_Constant_Centre.print_parameter_values">
<code class="descname">print_parameter_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient_Constant_Centre.print_parameter_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient_Constant_Centre.print_parameter_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s parameters values</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Metallicity_Gradient_Constant_Centre.update_model_parameters">
<code class="descname">update_model_parameters</code><span class="sig-paren">(</span><em>par</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Metallicity_Gradient_Constant_Centre.update_model_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Metallicity_Gradient_Constant_Centre.update_model_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the parameters of the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>par</strong> (<em>dictionary</em>) – dictionary in the shape {‘name’:parameter_name, ‘value’:parameter value}</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="frapy.models.Velocity_Arctangent">
<em class="property">class </em><code class="descclassname">frapy.models.</code><code class="descname">Velocity_Arctangent</code><span class="sig-paren">(</span><em>zlens</em>, <em>dfx_path</em>, <em>dfy_path</em>, <em>cx=0</em>, <em>cy=0</em>, <em>q=1</em>, <em>pa=0</em>, <em>v_t=100</em>, <em>r_t=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Velocity_Arctangent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Velocity_Arctangent" title="Permalink to this definition">¶</a></dt>
<dd><p>Exponential velocity model.</p>
<blockquote>
<div><p>This model inherits the distance and azimuthal maps, from which an arctangent model
of the velocity at each point is calculated assuming the following formulae:</p>
<p>$V(r) = v_t</p>
</div></blockquote>
<p>rac{2}{pi} arctan (
rac{2r}{r_t})$</p>
<blockquote>
<div><p>with r the radius in kpc, v_t the terminal velocity and r_t the transition radius.</p>
<dl class="docutils">
<dt>cx: int</dt>
<dd>x position of the centre (in pixels)</dd>
<dt>cy: int</dt>
<dd>y position of the centre (in pixels)</dd>
<dt>q: float</dt>
<dd>axis ratio (a/b)</dd>
<dt>pa: float</dt>
<dd>Position angle (0 North, +90 East )</dd>
<dt>v_t: float</dt>
<dd>Terminal velocity in km/s.</dd>
<dt>r_t: float</dt>
<dd>transition radius in kpc.</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="frapy.models.Velocity_Arctangent.make_model">
<code class="descname">make_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Velocity_Arctangent.make_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Velocity_Arctangent.make_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a model using the current parameters’ values and stores it
in the ‘data’ attribute</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Velocity_Arctangent.model_name">
<code class="descname">model_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Velocity_Arctangent.model_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Velocity_Arctangent.model_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s name</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Velocity_Arctangent.model_parameters">
<code class="descname">model_parameters</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Velocity_Arctangent.model_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Velocity_Arctangent.model_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s parameters</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Velocity_Arctangent.print_parameter_values">
<code class="descname">print_parameter_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Velocity_Arctangent.print_parameter_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Velocity_Arctangent.print_parameter_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model’s parameters values</p>
</dd></dl>

<dl class="method">
<dt id="frapy.models.Velocity_Arctangent.update_model_parameters">
<code class="descname">update_model_parameters</code><span class="sig-paren">(</span><em>par</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/models.html#Velocity_Arctangent.update_model_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.models.Velocity_Arctangent.update_model_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the parameters of the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>par</strong> (<em>dictionary</em>) – dictionary in the shape {‘name’:parameter_name, ‘value’:parameter value}</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-frapy.fit_model">
<span id="fitting"></span><h3>Fitting<a class="headerlink" href="#module-frapy.fit_model" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="frapy.fit_model.fit_model">
<code class="descclassname">frapy.fit_model.</code><code class="descname">fit_model</code><span class="sig-paren">(</span><em>obs</em>, <em>model</em>, <em>parameters</em>, <em>outputname</em>, <em>nsteps=1000</em>, <em>nwalkers=24</em>, <em>mask=None</em>, <em>binning_map=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/fit_model.html#fit_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.fit_model.fit_model" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Routine that fits the observations using a given model and the emcee sampler.</p>
<p>We make use of the emcee sampler (<a class="reference external" href="http://dfm.io/emcee/current/">http://dfm.io/emcee/current/</a>) to fit the free parameters of
the model to the observations. We are maximising the following log-probabiluty function:</p>
<p>$$ln(probability) = ln(priors) + ln(likelihood)$$</p>
<p>with the log likelohood function as:</p>
<p>$$ln(likelihood) = -</p>
</div></blockquote>
<p>rac{1}{2} (
rac{(data-model)^2}{uncertainty^2} + ln(2 pi uncertainty^2))$$</p>
<blockquote>
<div><p>Both the model and the observations should be instances of the Observations and BaseModel
classes from frapy.</p>
<p>The <em>parameters</em> input is a dictionary in the shape:</p>
<p>parameters = {parameter_name1:{‘value’:X, ‘min’:Y, ‘max’:Z}, parameter_name2:{‘value’:A, ‘min’:B,
‘max’:C},…}</p>
<p>where the parameter_name variables should correspond to the parameters in the model being used;
value is the starting value of each parameter; and min and max the minimum and maximum values
allowed. We assume uniform priors to all parameters (i.e. all values between min and max have
the same prior probability). Parameters not present in this dictionary will not be varied and
will be kept to the value of the input model.</p>
<p>It is possible to mask part of the data out by using a mask. This should be a 2D array, of the
same shape as the data, with only zeros (masked values) and ones (valid values). The maximisation
will be made using only the valid values.</p>
<p>If the data was binned when deriving the quantity being fit, i.e. if pixels were grouped and
analysed as a single pixel and that value taken as the value of all the pixels grouped, it is
possible to include this information using a <em>binning_map</em>. This should be a 2D array in which
pixels of the same bin are given the same value. Pixels in the image that were not analysed (not
included in the binning) should be given negative values. These are not included in the minimisation.</p>
<dl class="docutils">
<dt>obs: Observation</dt>
<dd>An instance of the Observation class</dd>
<dt>model: Metallicity_Gradient,Velocity</dt>
<dd>A frapy model (based in the BaseModel class)</dd>
<dt>parameters: dictionary</dt>
<dd>A dictionary containing the parameters of the model to be varied and their limits. Parameters not
in this dictionary will not be varied.</dd>
<dt>outputname: str</dt>
<dd>Name of the output pickle file.</dd>
<dt>nsteps: int</dt>
<dd>number of steps of the emcee walkers. Default: 1000</dd>
<dt>nwalkers: int</dt>
<dd>Number of emcee walkers. Default: 24</dd>
<dt>mask: array int</dt>
<dd>Array of the same shape as the data containing only zeros (masked values) or ones (valid values).
Optional.</dd>
<dt>binning_map: array int</dt>
<dd>Array of the same shape as the data containing encoding the pixels that were groupped togther.
Optional.</dd>
</dl>
<blockquote>
<div><dl class="docutils">
<dt>Returns a dictionary with:</dt>
<dd>sampler chain
sampler lnprobability
parameter names in the correct order
input parameters
the mask used
the binning map used
the observations
the model</dd>
</dl>
<p>This is also saved as a pickles file.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-frapy.check_fit">
<span id="explore-the-output"></span><h3>Explore the output<a class="headerlink" href="#module-frapy.check_fit" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="frapy.check_fit.Output">
<em class="property">class </em><code class="descclassname">frapy.check_fit.</code><code class="descname">Output</code><span class="sig-paren">(</span><em>outfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/check_fit.html#Output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.check_fit.Output" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows the output of <em>fit_model</em> to be inspected</p>
<p>Reads the pickle output and allows to plot:</p>
<blockquote>
<div>. the walkers positions at each iteration to check for convergence
. a corner plot of the results
. the 50th, 16th and 84th percentiles (mean and +/- 1 sigma)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>outfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – The name of the pickle file being inspected (without the ‘.pickle’ extension)</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="frapy.check_fit.Output.best_parameters">
<code class="descname">best_parameters</code><span class="sig-paren">(</span><em>start=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/check_fit.html#Output.best_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.check_fit.Output.best_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the  16th, 50th and 84th percentiles for each parameter.
Only uses iterations after ‘start’</p>
</dd></dl>

<dl class="method">
<dt id="frapy.check_fit.Output.check_convergence">
<code class="descname">check_convergence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/check_fit.html#Output.check_convergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.check_fit.Output.check_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the walkers positions at each iteration for each parameter as well as
the value of the log-likelihood probability for each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="frapy.check_fit.Output.goodness_of_fit">
<code class="descname">goodness_of_fit</code><span class="sig-paren">(</span><em>best_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/check_fit.html#Output.goodness_of_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.check_fit.Output.goodness_of_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dictionary with parameter names and values, calculates the
chi2, reduced chi2 (chi2/dof), the log-likelihood probability and the
Bayesian Information Criteria (BIC) for the model with those parameters
values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>best_parameters</strong> (<em>dictionary</em>) – Dictionary in the shape {parameter_name1:{value:X,min:Z,max:Z},parameter_name2:{value:X,min:Z,max:Z}}
(from the check_fit.best_parameters function, for example).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>chi2/dof</strong> – Reduced chi2</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="frapy.check_fit.Output.make_cornerplot">
<code class="descname">make_cornerplot</code><span class="sig-paren">(</span><em>start=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/check_fit.html#Output.make_cornerplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.check_fit.Output.make_cornerplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a corner plot of the results.
Only uses iterations after ‘start’</p>
</dd></dl>

<dl class="method">
<dt id="frapy.check_fit.Output.plot_solution">
<code class="descname">plot_solution</code><span class="sig-paren">(</span><em>best_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/check_fit.html#Output.plot_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.check_fit.Output.plot_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dictionary with parameter names and values, plots the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>best_parameters</strong> (<em>dictionary</em>) – Dictionary in the shape {parameter_name1:{value:X,min:Z,max:Z},parameter_name2:{value:X,min:Z,max:Z}}
(from the check_fit.best_parameters function, for example).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>model</strong> (<em>array float</em>) – the model with the best parameters</li>
<li><strong>residuals</strong> (<em>array float</em>) – the residuals (data - model)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-frapy.utils">
<span id="miscelaneous"></span><h3>Miscelaneous<a class="headerlink" href="#module-frapy.utils" title="Permalink to this headline">¶</a></h3>
<p>This module containts miscelaneous functions used in the fitting.</p>
<dl class="function">
<dt id="frapy.utils.make_input_parameters">
<code class="descclassname">frapy.utils.</code><code class="descname">make_input_parameters</code><span class="sig-paren">(</span><em>name</em>, <em>value</em>, <em>minimum</em>, <em>maximum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frapy/utils.html#make_input_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frapy.utils.make_input_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs a parameter dictionary to be used in the fit_model function.</p>
<p>This dictionary has the following form:</p>
<blockquote>
<div>{parameter_name1:{‘value’:X, ‘min’:Y, ‘max’:Z},
parameter_name2:{‘value’:A, ‘min’:B, ‘max’:C},
…
}</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>array str</em>) – An array of strings containing the names of the model’s parameters to be fitted.</li>
<li><strong>value</strong> (<em>array float</em>) – The initial values of these parameters (ACTUALLY NOT USED)</li>
<li><strong>minimum</strong> (<em>array float</em>) – The minimum value allowed for each parameter</li>
<li><strong>maximum</strong> (<em>array float</em>) – The maximum value allowed for each parameter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>parameter</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dictionary</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Vera Patricio

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>